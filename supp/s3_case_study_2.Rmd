---
title: "Case study: Sensitivity of intactness estimates"
date: "`r format(Sys.time(), '%d %B %Y')`"
author: "Vernier et al."
output:
  html_document:
    keep_md: false
    toc: false
    css: styles.css
---

---

# Introduction

This case study provides a simple illustration of the effects of mapping decisions on the area estimated to be intact. The study area consists of the boundary of the Caribou Mountains caribou range in Alberta (20,690.0 km2). We focus on two aspects only: i) buffer size around disturbances and ii) minimum size of an intact area. For both criteria, we used values that were used by some of the intactness and human influence datasets in this study (Table 1). For buffer size, we evaluated no buffers, 500-m buffers, and 1000-m buffers around anthropogenic disturbances. To keep the analysis simple, we applied the same buffer width to both linear and polygonal disturbances. Similarly, for minimum size, we used no minimum size, a 50 km2 minimum, and 500 km2 minimum.

Figure 1. Distribution of linear and polygonal disturbances in the Caribou Mountains range in Alberta.
<img src="output/cm_study_region.png">

Table 1. Percentage of study area identified as intact by intactness and human influence datasets.

|Dataset | Percent intact (%) |
| :------ | :-------- |
|HA2010 | 72.8 |
|CIFL2013 | 53.9 |
|GIFL2013 | 43.1 |
|GIFL2016 | 43.1 |
|HFP2013 | 99.9 |
|CHFP2019 | 97.0 |
|GHM2016 | 84.1 |
|VLIA2015 | 92.5 |
|AB2015 | 98.0 |

---


# Results

From our simple sensitivity analysis, we can see that the area estimated to be intact varies from 44-98% depending of buffer size and minimum area (Table 2, Figure 2). Moreover, we can see that buffer size has a larger influence than minimum patch size on the estimated area considered to be intact in the study region.

```{r echo=FALSE, message=F, warning=F}

x = read.csv("output/CaribouMountains.csv")
names(x) = c("Buffer size (m)", "Mininum area (km2)", "Area intact (km2)", "Percent intact (%)")
knitr::kable(x, caption="Table 2. Percentage of study area identified as being intact as a function of buffer size and minimum patch size.")
```

---

Figure 2. Distribution of intact area identified as a function of buffer size and minimum patch size.
<img src="output/CaribouMountains.png">

---

Figure 3. Coverage of linear and polygonal anthropogenic disturbances, and areas identified as intact by seven intactness and human influence datasets.

```{r echo=FALSE, message=F, warning=F}
#stopFun = function() {
cr = 'CaribouMountains'
library(sf)
library(leaflet)
library(knitr)
library(rgdal)
library(tidyverse)
opa = 1 # fill opacity
ab2000_col = '#cab2d6'
ab2015_col = '#cab2d6'
ha2010_col = '#ffff99'
cifl2000_col = '#b2df8a'
cifl2013_col = '#33a02c'
gifl2000_col = '#a6cee3'
gifl2013_col= '#1f78b4'
gifl2016_col= '#08519c'
hfp1993_col = '#fb9a99'
hfp2009_col = '#e31a1c'
hfp2013_col = '#e31a1c'
hfp2019_col = '#e31a1c'
vlia2015_col = '#fdbf6f'
ghm2015_col = '#ff7f00'
ff1996_col = '#6a3d9a'
dataDir = paste0('C:/Users/PIVER37/Documents/gisdata/intactness/ranges/',cr,'/')
dataDir2 = paste0('C:/Users/PIVER37/Documents/github/intactness/data/bead/',cr,'.gpkg')
bnd = st_read(paste0(dataDir,"bnd.shp"), quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
ha2010 = st_read(paste0(dataDir,"ha2010.shp"), quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
cifl2013 = st_read(paste0(dataDir,"cifl2013.shp"), quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
gifl2016 = st_read(paste0(dataDir,"gifl2016.shp"), quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
ab2015 = st_read(paste0(dataDir,"ab2015.shp"), quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
hf2013 = st_read(paste0(dataDir,"hfp2013.shp"), quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
hf2019 = st_read(dataDir2,"hfp2019", quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
vlia2015 = st_read(paste0(dataDir,"vlia2015.shp"), quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
ghm2016 = st_read(paste0(dataDir,"ghm2016.shp"), quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
poly = st_read (paste0(dataDir,"poly30.shp"), quiet=T) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))
line = st_read (paste0(dataDir,"line30.shp"), quiet=T) %>% st_buffer(1) %>% st_transform(CRS("+proj=longlat +datum=WGS84"))

m <- leaflet(bnd, width=900, height=600) %>%
    addProviderTiles("Esri.NatGeoWorldMap", group="Map") %>%
    addProviderTiles("Esri.WorldImagery", group="Imagery") %>%
    addPolygons(data=bnd, fill=F, weight=2, color="black", fillOpacity=1, group="Range") %>%
    addPolygons(data=line, fill=T, weight=1, color="black", fillOpacity=1, group="Linear") %>%
    addPolygons(data=poly, fill=T, weight=1, color="darkred", fillOpacity=1, group="Polygonal") %>%
    addPolygons(data=cifl2013, fill=T, weight=2, color=cifl2013_col, fillOpacity=opa, group="CIFL2013") %>%
    addPolygons(data=ha2010, fill=T, weight=2, color=ha2010_col, fillOpacity=opa, group="HA2010") %>%
    addPolygons(data=gifl2016, fill=T, weight=2, color=gifl2016_col, fillOpacity=opa, group="GIFL2016") %>%
    addPolygons(data=ab2015, fill=T, weight=2, color=ab2015_col, fillOpacity=opa, group="AB2015") %>%
    addPolygons(data=hf2013, fill=T, weight=2, color=hfp2013_col, fillOpacity=opa, group="HFP2013") %>%
    addPolygons(data=hf2019, fill=T, weight=2, color=hfp2013_col, fillOpacity=opa, group="CHFP2019") %>%
    addPolygons(data=vlia2015, fill=T, weight=2, color=vlia2015_col, fillOpacity=opa, group="VLIA2015") %>%
    addPolygons(data=ghm2016, fill=T, weight=2, color=ghm2015_col, fillOpacity=opa, group="GHM2016") %>%
    addLayersControl(position = "topright",
        baseGroups=c("Map", "Imagery"),
        overlayGroups = c("Range","Linear","Polygonal","HA2010","CIFL2013","GIFL2016","AB2015","HFP2013","CHFP2019","VLIA2015","GHM2016"),
        options = layersControlOptions(collapsed = FALSE)) %>%
        hideGroup(c("Linear","Polygonal","HA2010","CIFL2013","GIFL2016","AB2015","HFP2013","CHFP2019","VLIA2015","GHM2016"))

m
#}
```
